<?xml version="1.0" encoding="utf-8"?>
<odoo>

     <!-- The main base of the project.task list view -->
    <record id="reportpla_tree_view" model="ir.ui.view">
        <field name="name">mitsu_table_project.reportpla.list</field>
        <field name="model">mitsu_table_project.reportpla</field>
        <field name="arch" type="xml">
            <list string="Tableau planning" sample="1" default_order="id desc">
                <field name="create_date" string="Date" widget="date" readonly="1" />
                <field name="resource_id" readonly="1" />
                <field name="role_id" />
                <field name="project_id" />
                <field name="task_id" readonly="1"/>
                <field name="sale_line_id"  readonly="1"/>
                <field name="price_unit_table"  widget="monetary"  sum="Total prix unitaire"
                    readonly="1"/>
                <field name="quantity_table"  sum="Quantité" readonly="1"/>
                <field name="time_task_table" string="Temps sur la tâche" 
                    widget="timesheet_uom_no_toggle"  readonly="1"/>
                <field name="allocated_hours" string="Temps planifié" 
                    widget="float_time"  readonly="1"/>
                <field name="time_to_plan" string="Temps à planifier" 
                    widget="timesheet_uom_no_toggle"  optional="hide" readonly="1"/>
                <field name="time_to_realize" string="Temps réaliser" 
                    widget="timesheet_uom_no_toggle"  optional="hide" readonly="1"/>
                <field name="time_to_realize_effective" string="Temps à réaliser" 
                    widget="timesheet_uom_no_toggle"  optional="hide" readonly="1"/>
                <field name="hourly_cost_table" 
                    widget="monetary"  sum="Total coût unitaire de l'employée" optional="hide" readonly="1"/>
                <field name="employee_cost_total_task" 
                    widget="monetary"  optional="hide" readonly="1" sum="Total de l'employée"/>
                <field name="projected_sales" 
                    widget="monetary"  optional="hide" 
                    sum="Total Marge prévisionnel" readonly="1"/>
                <field name="marged_sales" 
                    widget="monetary"  optional="hide" 
                    sum="Total CA réaliser" readonly="1"/>
                <field name="boni_mali" optional="hide" decoration-success="boni_mali == 'bon'" decoration-danger="boni_mali == 'mal'" readonly="1"/>
                <field name="projected_sales_realize" 
                    widget="monetary"  optional="hide" sum="Total CA réaliser" readonly="1"/>
                <field name="employee_real_cost" 
                    widget="monetary" sum="Total Coût réel de l'employée"  optional="hide" readonly="1"/>
                <field name="marged_realize" 
                    widget="monetary"  optional="hide" 
                    sum="Total Marge réaliser" readonly="1"/>
                <field name="margin_difference" 
                    widget="monetary"  sum="Total Différence de marge" optional="hide" readonly="1"/>
                <field name="currency_id" column_invisible="True"/>
                <field name="id" optional="hide" options="{'enable_formatting': False}"/>
            </list>
        </field>
    </record>

    <record id="reportpla_search_view" model="ir.ui.view">
        <field name="name">mitsu_table_project.reportpla.search</field>
        <field name="model">mitsu_table_project.reportpla</field>
        <field name="arch" type="xml">
            <search>
                <field name="resource_id" groups="planning.group_planning_user"/>
                <field name="role_id" groups="planning.group_planning_user"/>
                <field name="company_id" groups="base.group_multi_company"/>
                <field name="department_id" groups="planning.group_planning_user"/>
                <field name="manager_id" groups="planning.group_planning_user"/>
                <!-- <field name="job_title" groups="planning.group_planning_user"/> -->
                <field name="name" groups="planning.group_planning_user"/>
                <!-- <field name="request_to_switch" groups="planning.group_planning_user"/> -->
                <!-- <filter name="open_shifts" string="Open Shifts" domain="[('resource_id', '=', False)]" context="{'show_role_open_shifts': 1}"/> -->
                <!-- <filter name="my_shifts" string="My Shifts" domain="[('user_id', '=', uid)]"/> -->
                <!-- <filter name="my_team_shifts" string="My Team" domain="[('manager_id.user_id', '=', uid)]" help="Shifts of Your Team Member" groups="planning.group_planning_user"/> -->
                <!-- <filter name="my_department_shifts" string="My Department" domain="[('employee_id.member_of_department', '=', True)]" help="Shifts of Your Department Member" groups="planning.group_planning_user"/> -->
                <!-- <filter name="unwanted_shifts" string="Requests to Switch" domain="[('request_to_switch', '=', True), ('end_datetime', '&gt;', datetime.datetime.now())]"/> -->
                <separator/>
                <filter string="My Roles" name="my_role" domain="[('role_id.resource_ids.user_id','=', uid)]" groups="planning.group_planning_user"/>
                <filter name="my_team_task" string="Taches Equipe" domain="[('manager_ids', 'in', [uid])]" help="Task in Your Team Member" groups="planning.group_planning_user"/>
                <separator/>
                <!-- <filter name="shift_planned" invisible="1" string="Shifts Planned" groups="planning.group_planning_user" context="{'highlight_planned': 1}"/> -->
                <!-- <filter name="conflict_shifts" string="Shifts in Conflict" groups="planning.group_planning_manager" context="{'highlight_conflicting': 1}"/> -->
                <separator/>
                <filter string="Employees" name="employees" domain="['|', '|', ('resource_type','=', 'user'), ('role_id.resource_ids.resource_type','=', 'user'), ('role_id','=', False)]" groups="planning.group_planning_user"/>
                <filter string="Materials" name="materials" domain="['|', '|', ('resource_type','=', 'material'), ('role_id.resource_ids.resource_type','=', 'material'), ('role_id','=', False)]" groups="planning.group_planning_user"/>
                <separator/>
                <filter name="unpublished_shifts" string="Draft" domain="[('state', '=', 'draft')]" groups="planning.group_planning_manager"/>
                <filter name="published_shifts" string="Published" domain="[('state', '=', 'published')]" groups="planning.group_planning_manager"/>
                <separator groups="planning.group_planning_manager"/>
                <filter string="Start Date" name="start_datetime" date="start_datetime" end_month="1">
                    <filter name="start_today" string="Today" domain="[                         ('start_datetime', '&lt;=', datetime.datetime.combine(context_today(), datetime.time(23,59,59)).to_utc()),                         ('start_datetime', '&gt;=', datetime.datetime.combine(context_today(), datetime.time(0,0,0)).to_utc()),                     ]"/>
                    <filter name="start_this_week" string="This Week" domain="[                         ('start_datetime', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=-1,days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                         ('start_datetime', '&lt;', datetime.datetime.combine(context_today() + relativedelta(days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                     ]"/>
                    <filter name="start_next_week" string="Next Week" domain="[                         ('start_datetime', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                         ('start_datetime', '&lt;', datetime.datetime.combine(context_today() + relativedelta(weeks=1,days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                     ]"/>
                </filter>
                <filter string="End Date" name="end_datetime" date="end_datetime" end_month="1">
                    <filter name="end_today" string="Today" domain="[                         ('end_datetime', '&gt;=', datetime.datetime.combine(context_today(), datetime.time(0,0,0)).to_utc()),                         ('end_datetime', '&lt;=', datetime.datetime.combine(context_today(), datetime.time(23,59,59)).to_utc()),                     ]"/>
                    <filter name="end_this_week" string="This Week" domain="[                         ('end_datetime', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=-1,days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                         ('end_datetime', '&lt;', datetime.datetime.combine(context_today() + relativedelta(days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                     ]"/>
                    <filter name="end_next_week" string="Next Week" domain="[                         ('end_datetime', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                         ('end_datetime', '&lt;', datetime.datetime.combine(context_today() + relativedelta(weeks=1,days=1,weekday=0), datetime.time(0,0,0)).to_utc()),                     ]"/>
                </filter>    
                <group string="Group By">
                    <filter name="group_by_department" string="Department" context="{'group_by': 'department_id'}" groups="planning.group_planning_user"/>
                    <filter name="group_by_manager" string="Manager" context="{'group_by': 'manager_id'}" groups="planning.group_planning_user"/>
                    <filter name="group_by_resource" string="Resource" context="{'group_by': 'resource_id'}" groups="planning.group_planning_user"/>
                    <filter name="group_by_role" string="Role" context="{'group_by': 'role_id'}"/>
                    <filter name="group_by_company" string="Company" context="{'group_by': 'company_id'}" groups="base.group_multi_company"/>
                    <filter name="group_by_start_datetime" string="Start Date" context="{'group_by':'start_datetime:day'}"/>
                    <filter name="group_by_end_datetime" string="End Date" context="{'group_by':'end_datetime:day'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- <record model="ir.actions.act_window.view" id="planning_list_mitsu">
        <field name="sequence" eval="1"/>
        <field name="view_mode">list</field>
        <field name="view_id" ref="planning_task_view_tree_table_mutsi"/>
        <field name="act_window_id" ref="action_planning_slot_mutsi"/>
    </record> -->

    <record id="action_reportpla_mutsi_view" model="ir.actions.act_window">
        <field name="name">Rapport 2</field>
        <field name="res_model">mitsu_table_project.reportpla</field>
        <field name="view_mode">list</field>
        <field name="context">{}</field>
        <field name="search_view_id" ref="mitsu_table_project.reportpla_search_view" />
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
          </p><p>
            Creez des taches.
          </p>
        </field>
    </record>

    <menuitem id="menu_main_pm_report_pla"
              name="Rapport 2"
              parent="project.menu_main_pm"
              action="action_reportpla_mutsi_view"
              sequence="13"/>
</odoo>
