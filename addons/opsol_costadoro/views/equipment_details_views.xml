<odoo>

	<record id="view_client_equipment_search_opsol" model="ir.ui.view">
        <field name="name">equipment.details.form</field>
        <field name="model">equipment.details</field>
        <field name="inherit_id" ref="client_equipment.view_client_equipment_search" />
        <field name="arch" type="xml">

            <field name="serial_no" position="after">
                <field name="equip_model_id"/>
            </field>

            <field name="name" position="attributes">
                <attribute name="filter_domain">['|', ('serial_no', 'ilike', self), ('name', 'ilike', self)]</attribute>
            </field>

            <xpath expr="//filter[@name='group_by_manufacturer']" position="after">
                <filter name="group_model_equip" context="{'group_by': 'equip_model_id'}"/>
            </xpath>

        </field>
    </record>

    <record id="view_equipment_details_form_opsol" model="ir.ui.view">
        <field name="name">equipment.details.form</field>
        <field name="model">equipment.details</field>
        <field name="inherit_id" ref="client_equipment.view_equipment_details_form" />
        <field name="arch" type="xml">
            
            <xpath expr="//notebook[1]" position="inside">
                <page string="Metriques" name="tab_metric">
                    <field name="lines_metric_ids" nolabel="1" context="{'default_equipment_id': id}">
                        <list editable="bottom">
                            <field name="metric_id"/>
                            <field name="reference_intervention"/>
                            <field name="uom_id"/>
                            <field name="current_measure"/>
                            <field name="progress_metric" widget="percentage"/>
                            <field name="equipment_id" column_invisible="1"/>
                            <field name="partner_id" column_invisible="1"/>
                        </list>
                    </field>
                </page>
                <page string="Historique" name="tab_his_location">
                    <field name="history_location_ids" nolabel="1" context="{'default_equip_id': id}" >
                        <list editable="top" default_order="date desc">
                            <field name="equip_id" column_invisible="True" />
                            <field name="date"/>
                            <field name="partner_id"/>
                            <field name="cost_state"/>
                            <field name="date_debut"/>
                            <field name="date_fin" />
                        </list>
                    </field>
                </page>
            </xpath>

            <xpath expr="//field[@name='image']" position="before">
                <header>
                    <button name="create_intervention" string="Creer Intervention"  type="object"/>
                    <button name="action_addentry" string="Ajouter Mesure"  type="object"/>
                    <button name="reset_indicators" string="reinitialiser Indicateurs"  type="object" confirm="Vous confirmez la reinitialisation ?"/>
                    <field name="cost_state" widget="statusbar" options="{'clickable': '1'}" />
                </header>
            </xpath>

            <xpath expr="//field[@name='location']" position="after">
                <field name="last_intervention" />
                <field name="move_ids" invisible="True" />
            </xpath>

            <xpath expr="//field[@name='image']" position="before">
                <div name="button_box">
                    <button name="action_open_intervention" type="object" class="oe_stat_button" icon="fa-bolt" >
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="fsm_count"/></span>
                            <span class="o_stat_text">Interventions</span>
                        </div>
                    </button>
                    <button name="action_open_revision" type="object" class="oe_stat_button" icon="fa-cogs" >
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="fsm_rev_count"/></span>
                            <span class="o_stat_text">Revisions</span>
                        </div>
                    </button>
                    <button name="action_open_intervention_prev" type="object" class="oe_stat_button" icon="fa-cog">
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="fsm_count_prev"/></span>
                            <span class="o_stat_text">Interventions Preventives</span>
                        </div>
                    </button>
                    <button name="action_open_saleorder" type="object" class="oe_stat_button" icon="fa-file-text" invisible="saleorder_count == 0">
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="saleorder_count"/></span>
                            <span class="o_stat_text">Bon de commande</span>
                        </div>
                    </button>
                    <button name="action_open_picking" type="object" class="oe_stat_button" icon="fa-truck" invisible="picking_number == 0">
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="picking_number"/></span>
                            <span class="o_stat_text">Livraisons</span>
                        </div>
                    </button>
                    <field name="partner_history_ids" invisible="1"/>
                    <button name="action_open_historique" type="object" class="oe_stat_button" icon="fa-history" invisible="not partner_history_ids">
                        <div class="o_field_widget o_stat_info"><span class="o_stat_text">Historique</span></div>
                    </button>
                </div>
            </xpath>

            <xpath expr="//field[@name='model']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>
            <xpath expr="//field[@name='model']" position="after">
                <field name="equip_model_id" />
            </xpath>
            <xpath expr="//label[@for='street']" position="before">
                <field name="date_debut"/>
                <field name="date_fin" />
            </xpath>

            <xpath expr="//field[@name='site_phone']" position="after">
                <field name="ana_acc_id"/>
            </xpath>

            <xpath expr="//label[@for='name']" position="after">
                <label for="serial_no"/>
            </xpath>

            <xpath expr="//field[@name='name']" position="after">
                <field name="serial_no" position="move"/>
            </xpath>

            <xpath expr="//field[@name='serial_no']" position="attributes">
                <attribute name="placeholder">e.g. VTY3390056"</attribute>
            </xpath>

            <xpath expr="//label[@for='name']" position="replace">
            </xpath>

            <xpath expr="//field[@name='name']" position="replace">
            </xpath>
            
            <xpath expr="//field[@name='model']" position="after">
                <field name="name" invisible="1"/>
            </xpath>

        </field>
    </record>

</odoo>